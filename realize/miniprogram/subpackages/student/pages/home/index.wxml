<view class="page">
  <view class="profile card">
    <view class="flex-between">
      <view>
        <view class="profile-name">{{profile.name}}</view>
        <view class="profile-desc">{{profile.major}} · {{profile.studentNo}}</view>
      </view>
      <button size="mini" class="switch-role" bindtap="handleRefresh">
        {{refreshing ? '刷新中...' : '刷新'}}
      </button>
    </view>
  </view>

  <section-header title="本周出勤" action-text="查看详情" bindaction="handleHistory"></section-header>
  <view class="stats-grid">
    <stats-card title="出勤率" value="{{stats.weekAttendance}}" trend="{{stats.trend}}" description="较上周">
    </stats-card>
    <stats-card title="迟到次数" value="{{stats.lateCount}}" trend="-" description="本周累计">
    </stats-card>
    <stats-card title="缺勤次数" value="{{stats.absentCount}}" trend="-" description="本周累计">
    </stats-card>
  </view>

  <section-header title="今日课程"></section-header>
  <view wx:for="{{courses}}" wx:key="id" class="course card" data-id="{{item.id}}" bindtap="handleCourseTap">
    <view class="course-title">{{item.name}}</view>
    <view class="course-meta">{{item.time}} · {{item.location}}</view>
    <view class="course-footer">
      <view class="teacher">{{item.teacher}}</view>
      <view class="status {{item.status}}">{{item.status === 'ongoing' ? '进行中' : item.status === 'upcoming' ? '即将开始' : '已结束'}}</view>
    </view>
  </view>

  <section-header title="提醒"></section-header>
  <view wx:for="{{reminders}}" wx:key="id" class="reminder {{item.type}}">
    {{item.text}}
  </view>

  <view class="card actions">
    <button size="mini" bindtap="handleSubscribe">订阅签到提醒</button>
    <button size="mini" type="primary" bindtap="handleHistory">查看签到记录</button>
  </view>
</view>
