<view class="page">
  <view class="card form-card">
    <view class="field">
      <view class="label">课程名称</view>
      <input placeholder="如：高等数学" data-field="course" value="{{form.course}}" bindinput="handleInput" />
    </view>
    <view class="field">
      <view class="label">类型</view>
      <picker mode="selector" range="{{types}}" value="{{types.indexOf(form.type)}}" bindchange="handleTypeChange">
        <view class="picker-value">{{form.type}}</view>
      </picker>
    </view>
    <view class="field">
      <view class="label">原因说明</view>
      <textarea placeholder="请输入具体原因" data-field="reason" value="{{form.reason}}" bindinput="handleInput" />
    </view>
    <button type="primary" loading="{{submitting}}" bindtap="handleSubmit">提交补签申请</button>
  </view>

  <section-header title="历史记录"></section-header>
  <view class="empty" wx:if="{{loadingRecords}}">加载中...</view>
  <view class="empty" wx:elif="{{!records.length}}">暂无记录</view>
  <block wx:else>
    <view class="record card" wx:for="{{records}}" wx:key="id">
      <view class="record-header">
        <view class="course">{{item.course}}</view>
        <view class="status {{item.status}}">{{item.status === 'approved' ? '已通过' : item.status === 'pending' ? '审核中' : '已驳回'}}</view>
      </view>
      <view class="detail">{{item.date}} · {{item.reason}}</view>
      <view class="detail">审批人：{{item.approver}}</view>
    </view>
  </block>
</view>
