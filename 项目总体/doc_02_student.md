# 智能考勤小程序 - 学生端功能设计

## 一、首页功能

### 1.1 核心展示内容
- 个人信息：头像、姓名、学号、专业
- 今日课程列表：显示当天所有课程
- 快捷入口：扫码签到、补签申请、考勤记录、消息通知
- 本周出勤统计：正常/迟到/缺勤次数、出勤率

### 1.2 课程卡片信息
每门课程显示：
- 上课时间段
- 课程名称
- 教室地点
- 任课教师
- 签到状态（未开始/进行中/已签到/已缺勤）

### 1.3 交互功能
- 点击课程卡片跳转签到页面
- 点击地点查看地图位置
- 下拉刷新更新状态
- 签到开始时推送通知

### 1.4 提醒机制
- 上课前15分钟推送上课提醒
- 签到开始时推送签到提醒
- 签到即将结束前2分钟提醒（未签到时）

---

## 二、签到功能

### 2.1 签到流程设计

#### 标准模式（定位+二维码）
1. 进入签到页面
2. 自动开始定位验证
3. 定位成功后激活扫码按钮
4. 扫描教师二维码
5. 验证成功，完成签到

#### 高安全模式（定位+二维码+人脸）
1. 进入签到页面
2. 自动开始定位验证
3. 定位成功后激活扫码按钮
4. 扫描教师二维码
5. 弹出人脸识别界面
6. 完成活体检测和人脸比对
7. 验证成功，完成签到

#### 便捷模式（仅二维码）
1. 进入签到页面
2. 点击扫码按钮
3. 扫描教师二维码
4. 验证成功，完成签到

### 2.2 页面展示内容
- 课程基本信息（名称、教师、时间、地点）
- 签到倒计时
- 签到要求说明
- 验证进度指示
- 定位状态显示
- 扫码按钮
- 人脸识别窗口（高安全模式）

### 2.3 定位验证
**功能要求**：
- 自动获取GPS位置
- 计算与教室的距离
- 判断是否在有效范围内（50米）
- 显示定位状态和距离

**状态反馈**：
- 定位中：显示加载动画
- 定位成功：显示距离，绿色提示
- 距离较远：黄色警告
- 不在范围：红色错误，提示原因

**异常处理**：
- GPS信号弱：提示移动到窗边或室外
- 定位失败：提供重新定位按钮
- 权限未授予：引导开启定位权限

### 2.4 二维码验证
**功能要求**：
- 调用微信扫码API
- 验证二维码有效性
- 检查是否为当前课程
- 检查是否在有效时间内

**状态反馈**：
- 扫码中：显示相机界面
- 验证中：显示加载动画
- 验证成功：绿色提示
- 验证失败：显示失败原因

**常见错误**：
- 二维码已过期
- 二维码无效
- 不是本课程二维码
- 网络连接失败

### 2.5 人脸识别（可选）
**功能要求**：
- 调用前置摄像头
- 检测人脸位置
- 活体检测（眨眼、点头、张嘴）
- 与预录入人脸比对

**识别流程**：
1. 人脸检测：引导用户正对相机
2. 活体检测：提示完成指定动作
3. 人脸比对：与数据库照片对比
4. 返回结果：成功或失败

**异常处理**：
- 未检测到人脸：引导调整位置
- 光线不足：提示移动到光线充足处
- 识别失败：可重试3次
- 未录入人脸：引导录入

### 2.6 签到结果
**成功提示**：
- 显示成功动画
- 显示签到时间
- 显示签到状态（正常/迟到）
- 返回首页按钮

**失败提示**：
- 显示失败原因
- 提供解决建议
- 提供重试按钮
- 提供联系教师入口

---

## 三、考勤记录功能

### 3.1 记录查询
**筛选条件**：
- 学期选择：本学期、上学期、全部
- 课程筛选：全部课程或指定课程
- 状态筛选：全部、正常、迟到、缺勤、已补签

### 3.2 记录列表
**显示内容**：
- 课程名称
- 签到日期和时间
- 签到状态（带颜色标识）
- 操作按钮（查看详情/申请补签）

**状态标识**：
- 正常：绿色
- 迟到：黄色
- 缺勤：红色
- 已补签：蓝色

### 3.3 记录详情
**详细信息**：
- 课程完整信息
- 签到时间（精确到秒）
- 签到位置（地图显示）
- 验证方式
- 定位距离
- 签到设备信息

### 3.4 统计信息
**本学期统计**：
- 签到总次数
- 正常/迟到/缺勤/补签次数
- 出勤率百分比

**趋势分析**：
- 按周或月的出勤率变化
- 各课程出勤情况对比

---

## 四、补签申请功能

### 4.1 申请提交
**选择缺勤记录**：
- 从考勤记录中选择缺勤的课程
- 显示课程基本信息

**填写申请信息**：
1. 选择请假类型（必填）
   - 病假：因病无法上课
   - 事假：个人或家庭原因
   - 公假：学校活动、竞赛等
   - 其他：特殊情况

2. 填写详细说明（必填，10-200字）
   - 清晰说明请假原因
   - 提供具体情况描述

3. 上传证明材料（建议）
   - 最多6张图片
   - 单张<5MB
   - 支持拍照或相册选择

**提交前确认**：
- 显示申请摘要
- 二次确认提交

### 4.2 申请管理
**申请记录查看**：
- 待审批列表：显示审批中的申请
- 已处理列表：显示已审批的申请

**申请详情**：
- 课程信息
- 申请类型和说明
- 证明材料
- 审批状态
- 审批人和审批时间
- 审批意见

**申请操作**：
- 待审批申请可撤销
- 已驳回申请可查看驳回理由
- 已驳回申请可修改后重新提交

### 4.3 审批通知
**实时通知**：
- 申请提交成功通知
- 审批结果通知（通过/驳回）
- 站内消息提醒

**通知内容**：
- 课程名称
- 审批结果
- 审批意见
- 跳转到详情链接

---

## 五、消息通知功能

### 5.1 通知类型
- 签到提醒：上课前和签到开始时
- 审批结果：补签申请审批完成
- 系统公告：重要通知
- 考勤预警：缺勤次数过多提醒

### 5.2 消息列表
**显示内容**：
- 消息标题
- 消息内容摘要
- 发送时间
- 未读标记

**交互功能**：
- 点击消息查看详情
- 点击跳转到相关页面
- 标记已读/未读
- 删除消息

### 5.3 推送设置
**可配置项**：
- 签到提醒开关
- 提醒时间设置
- 审批通知开关
- 系统公告开关

---

## 六、个人设置功能

### 6.1 个人资料
**可编辑信息**：
- 头像
- 姓名
- 联系方式
- 个性签名

**不可编辑信息**：
- 学号
- 专业
- 班级

### 6.2 人脸管理
**功能**：
- 录入人脸：拍摄多角度照片
- 更新人脸：重新录入
- 删除人脸：清除数据

**录入流程**：
1. 阅读使用说明和隐私政策
2. 拍摄正面照
3. 拍摄侧面照（可选）
4. 系统提取特征
5. 录入成功

### 6.3 其他设置
- 修改密码（如有独立账号）
- 隐私设置
- 帮助与反馈
- 关于小程序
- 退出登录

---

## 七、特殊场景处理

### 7.1 网络异常
- 显示友好的错误提示
- 提供刷新/重试按钮
- 缓存关键数据，网络恢复后同步

### 7.2 定位异常
- GPS信号弱：提示移动到窗边
- 室内定位不准：建议连接WiFi
- 定位失败：记录异常，教师可手动签到

### 7.3 设备异常
- 相机权限未开启：引导开启
- 存储空间不足：提示清理
- 系统版本过低：提示升级

### 7.4 签到超时
- 签到结束后无法再签到
- 提示申请补签
- 显示缺勤记录

---

## 八、性能优化建议

### 8.1 页面加载
- 首屏快速加载
- 使用骨架屏占位
- 图片懒加载
- 数据分页加载

### 8.2 流畅度
- 避免频繁的全量刷新
- 使用虚拟列表
- 减少不必要的计算
- 优化动画性能

### 8.3 数据缓存
- 缓存课程信息
- 缓存考勤记录
- 本地保存草稿
- 及时清理过期数据